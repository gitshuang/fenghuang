<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="format-detection"content="telephone=no">
<title>带导航索引（视频）页</title>
<!-- 默认动画css -->
<link rel="stylesheet" type="text/css" href="css/animate.css" />
<!-- demo css -->
<link rel="stylesheet" type="text/css" href="css/demo_leftIndex.css" /> 
</head>
<body>
<!-- loading S -->
<div class="loadPage">
	<!-- 可添加图片为背景 S-->
	<!-- <img class="pageBg" src="images/pagebg.jpg" alt=""/> -->
	<!-- 可添加图片为背景 E -->
	<strong class="loadNum">0%</strong>
	<!-- Loading动画 -->
	<div class="loadAnimation"></div>
	<!-- Loading装饰图 -->
	<img class="loadDec" width="100%" src="images/load_dec.png" alt=""/>
</div>
<!-- loading E -->

<!-- global S -->
<div class="global ease">
	<div class="screen">
		<!-- page 1 S -->
		<div class="layout" id="layout_1">
			<!-- 背景 S-->
			<img class="pageBg" src="images/pagebg.jpg" alt=""/>
			<!-- 背景 E -->
			<!-- 动画元素 S -->
			<img class="logo animated zoomInUp" src="images/img_logo.png" alt=""/>
			<img class="slogen animated zoomInDown" src="images/img_slogen.png" alt=""/>
			<!-- 动画元素 E -->
			<!-- 箭头 S -->
			<div class="swipeTip fadeOutUp"></div>
			<!-- 箭头 E -->
		</div>
		<!-- page 1 E -->

		<!-- page 2 S -->
		<div class="layout" id="layout_2">
			<!-- 背景 S-->
			<img class="pageBg" src="images/pagebg.jpg" alt="" />
			<!-- 背景 E -->
			<div class="box fadeIn animated">
				<p class="bd">
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文字<br/>
					文字文字文字文字<br/>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文字<br/>
					文字文字文字文字文字文字<br/>
					文字文字文字文字文字文字文字文字
				</p>
			</div>
			<!-- 箭头 S -->
			<div class="swipeTip fadeOutUp"></div>
			<!-- 箭头 E -->
		</div>
		<!-- page 2 E -->

		<!-- page 3 S -->
		<div class="layout" id="layout_3">
			<img class="indexBg" username="通栏一" src="images/pagebg.jpg" />
			<div class="videoBox fadeIn animated">
				<img src="images/videoBg.jpg" alt="" />
			</div>
			<div class="indexTxt fadeIn animated">
				<p>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文<br/>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文文字文字文字文字文字文<br/>
					文字文字文字文字文字文<br/>
				</p>
			</div>
			<!-- 箭头 S -->
			<div class="swipeTip fadeOutUp"></div>
			<!-- 箭头 E -->
		</div>
		<!-- page 3 E -->
		
		<!-- page 4 S -->
		<div class="layout" id="layout_4">
			<img class="indexBg" username="通栏二" src="images/pagebg.jpg" />
			<div class="videoBox fadeIn animated">
				<img src="images/videoBg.jpg" alt="" />
			</div>
			<div class="indexTxt fadeIn animated">
				<p>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文<br/>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文文字文字文字文字文字文<br/>
					文字文字文字文字文字文<br/>
				</p>
			</div>
			<!-- 箭头 S -->
			<div class="swipeTip fadeOutUp"></div>
			<!-- 箭头 E -->
		</div>
		<!-- page 4 E -->		
		
		<!-- page 5 /S -->
		<div class="layout" id="layout_5">
			<img class="indexBg" username="通栏三" src="images/pagebg.jpg" />
			<div class="videoBox fadeIn animated">
				<img src="images/videoBg.jpg" alt="" />
			</div>
			<div class="indexTxt fadeIn animated">
				<p>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文<br/>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文文字文字文字文字文字文<br/>
					文字文字文字文字文字文<br/>
				</p>
			</div>
			<!-- 箭头 S -->
			<div class="swipeTip fadeOutUp"></div>
			<!-- 箭头 E -->
		</div>
		<!-- page 5 E -->

		<!-- page 6 S -->
		<div class="layout" id="layout_6">
			<img class="indexBg" username="通栏四" src="images/pagebg.jpg" />
			<div class="videoBox fadeIn animated">
				<img src="images/videoBg.jpg" alt="" />
			</div>
			<div class="indexTxt fadeIn animated">
				<p>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文<br/>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文文字文字文字文字文字文<br/>
					文字文字文字文字文字文<br/>
				</p>
			</div>
			<!-- 箭头 S -->
			<div class="swipeTip fadeOutUp"></div>
			<!-- 箭头 E -->
		</div>
		<!-- page 6 E -->

		<!-- page 7 S -->
		<div class="layout" id="layout_7">
			<img class="indexBg" username="通栏五" src="images/pagebg.jpg" />
			<div class="videoBox fadeIn animated">
				<img src="images/videoBg.jpg" alt="" />
			</div>
			<div class="indexTxt fadeIn animated">
				<p>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文<br/>
					文字文字文字文字文字文字文字文字<br/>
					文字文字文字文字文字文文字文字文字文字文字文<br/>
					文字文字文字文字文字文<br/>
				</p>
			</div>
		</div>
		<!-- page 7 E -->
	</div>
</div>
<!-- global E -->

<!-- topBar S -->
<div class="topBar">
	<div class="fl"><span class="btn_menu"></span></div>
	<div class="fr"></div>
</div>
<!-- topBar E -->

<!-- leftBar S -->
<div class="menu" id="menu">
	<ul>
		<li>通栏一</li>
		<li>通栏二</li>
		<li>通栏三</li>
		<li>通栏四</li>
		<li>通栏五</li>
	</ul>
	<span class="scrollTip fadeOutUp"></span>
</div>
<!-- leftBar E -->
<script type="text/javascript" src="js/zepto.min.js"></script>
<script type="text/javascript" src="js/touch.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/iscroll.js"></script>
<script type="text/javascript">
/* ua */
var UA = function() {
	var userAgent = navigator.userAgent.toLowerCase();
	return {
		ipad: /ipad/.test(userAgent),
		iphone: /iphone/.test(userAgent),
		android: /android/.test(userAgent),
		qqnews: /qqnews/.test(userAgent),
		weixin: /micromessenger/.test(userAgent)
	};
}
/* page */
var pageIndex;
var Layout = {
	page: function(i, _h){
		$(".global").css({"-webkit-transform":"translate3d(0px, -" + _h * i + "px, 0px)"});
		$(".layout").removeClass("animate");
		$("#layout_" + (i + 1)).addClass("animate");
		pageIndex = i;
		//顶部栏判断，如果索引内容后还有单独的页面，这部分要重新判断。
		if ($(".layout").eq(pageIndex).find('.indexBg').length == 0 && i != $('.layout').length - 1) {
			$('.topBar').hide();
		}
		if ($(".layout").eq(pageIndex).find('.indexBg').length && pageIndex != -1) {
			$('.topBar').find('.fr').html($(".layout").eq(pageIndex).find('.indexBg').attr('username'));
			setTimeout(function() {
				$('.topBar').show();
			}, 1000)
		}	
	},
	swipe: function(_h, _len){
        var _this = this;
        $(".layout").each(function(index1, obj){
            $(obj).on("swipeUp", function(){
                if(index1<_len-1){
                _this.page(index1 + 1, _h);}
            }).on("swipeDown", function(){
                _this.page(index1 - 1, _h);
            });
        }); 
    },
	init: function() {
		var _this = this,
			_w = $(window).width(),
			_h = $(window).height(),
			_len = $(".layout").length;
		var ua = UA();
		$(".screen").width(_w).height(_h * _len);
		$(".layout").width(_w).height(_h);
		$('.indexTxt').height(_h - 236);
		$('.menu').height(_h - 36);//36: 顶部导航的高度
		_this.page(0, _h);
		_this.swipe(_h, _len);
		// 屏幕尺寸调整
        $(window).resize(function(){
            _this.init();
        });
	}
}
Layout.init();
var menuAnimation = {
	menuShow:function(){
		$('.menu').animate({//左侧导航滑入
			'left': '0'
		});
		$('.layout').removeClass('g_cur');
		$('.layout').eq(pageIndex).addClass('g_cur');
		setTimeout(function() {
			$('.scrollTip').removeClass('fadeOutUp').fadeOut();
		}, 8000);
	},
	menuHide:function(){
		$('.menu').animate({
			'left': '-115px'
		});
		$('.layout').eq(pageIndex).addClass('g_out');
		setTimeout(function() {
			$('.layout').removeClass('g_cur g_out');
		}, 500)
	}
}

$('.btn_menu').click(function() {
	menuAnimation.menuShow()
})
var _h = $(window).height();
$('.menu li').click(function() {
	Layout.page($(this).index() + 2, _h);//显示选定页面，2: 导航索引之前有两个未参与索引的页面
	menuAnimation.menuHide()
})
$('.layout').click(function() {
	menuAnimation.menuHide()
})
$('.layout').on("swipe",function() {
	menuAnimation.menuHide()
})
var myscroll;
var opts = {
	vScrollbar: false,
	hScrollbar: false
};
function loaded() {
	setTimeout(function() {
		myscroll = new iScroll("menu", opts);
	}, 2000);
}
$('#menu').on('touchmove', function(e) {
	e.preventDefault();
});
$(document).on('DOMContentLoaded', function() {
	setTimeout(loaded, 2000);
});

// loading
var loadImg = function(pics, callback) {
	var index = 0;
	var len = pics.length;
	var img = new Image();
	var flag = false;
	var progress = function(w) {
		$('.loadAnimation').animate({
			'height': w
		}, 'fast', 'linear', function() {
			$('.loadNum').html(w);
		})
	}
	var load = function() {
		img.src = pics[index];
		img.onload = function() {
			progress(Math.floor(((index + 1) / len) * 100) + "%");
			index++;
			if (index < len) {
				load();
			} else {
				callback()
			}
		}
		return img;
	}
	if (len > 0) {
		load();
	} else {
		progress("100%");
	}
	return {
		pics: pics,
		load: load,
		progress: progress
	};
}
var pics = [
		'images/load_bg01.png',
		'images/load_dec.png'
	]
loadImg(pics, function() {
	setTimeout(function() {
		$(".loadPage").hide();
	},500);
});
</script>
</body>
</html>